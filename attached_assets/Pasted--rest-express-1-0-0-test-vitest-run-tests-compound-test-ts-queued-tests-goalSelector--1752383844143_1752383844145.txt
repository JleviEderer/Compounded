
> rest-express@1.0.0 test
> vitest run



 ❯ tests/compound.test.ts [queued]
 ❯ tests/goalSelector.test.tsx [queued]

 ❯ tests/compound.test.ts 0/9
 ❯ tests/goalSelector.test.tsx [queued]
stderr | tests/compound.test.ts > Compound Growth Calculations > should calculate momentum index with compound growth
Unknown weight value undefined, defaulting to MEDIUM


 ❯ tests/compound.test.ts 1/9
 ❯ tests/goalSelector.test.tsx [queued]
stdout | tests/compound.test.ts > Compound Growth Calculations > should generate momentum history
Momentum history: 3 days from 2024-01-01 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0


 ❯ tests/compound.test.ts 1/9
 ❯ tests/goalSelector.test.tsx [queued]
stderr | tests/compound.test.ts > Compound Growth Calculations > should generate momentum history
Unknown weight value undefined, defaulting to MEDIUM
Unknown weight value undefined, defaulting to MEDIUM
Unknown weight value undefined, defaulting to MEDIUM


 ❯ tests/compound.test.ts 1/9
 ❯ tests/goalSelector.test.tsx [queued]
stdout | tests/compound.test.ts > Compound Growth Calculations > should generate 30-day projection
[DRATE] 2025-06-11 0 0


 ❯ tests/compound.test.ts 1/9
 ❯ tests/goalSelector.test.tsx [queued]
stderr | tests/compound.test.ts > Compound Growth Calculations > should generate 30-day projection
Unknown weight value undefined, defaulting to MEDIUM
Unknown weight value undefined, defaulting to MEDIUM

stderr | tests/compound.test.ts > Compound Growth Calculations > should handle edge cases
Unknown weight value undefined, defaulting to MEDIUM


 ❯ tests/compound.test.ts 1/9
 ❯ tests/goalSelector.test.tsx [queued]
 ❯ tests/compound.test.ts (9 tests | 4 failed) 107ms
   ✓ Compound Growth Calculations > should validate the compound formula: 1.001^365 ≈ 1.440194 3ms
   × Compound Growth Calculations > should calculate daily rate correctly 14ms
     → expected 0.0003 to be 0.0025 // Object.is equality
   × Compound Growth Calculations > should calculate momentum index with compound growth 13ms
     → expected 1.00090018 to be close to 1.006009, received difference is 0.005108820000000014, but expected 0.0000049999999999999996
   ✓ Compound Growth Calculations > should clamp momentum index to >= 0 0ms
   ✓ Compound Growth Calculations > should generate momentum history 57ms
   × Compound Growth Calculations > should generate 30-day projection 12ms
     → expected [ { date: '2025-07-14', …(4) }, …(6) ] to have a length of 30 but got 7
   ✓ Compound Growth Calculations > should calculate success rate 0ms
   ✓ Compound Growth Calculations > should handle edge cases 1ms
   × Compound Growth Calculations > should maintain precision in compound calculations 2ms
     → expected 1.0201992998981269 to be close to 1.0512, received difference is 0.031000700101873058, but expected 0.0005

 ❯ tests/compound.test.ts 9/9
 ❯ tests/goalSelector.test.tsx [queued]
stdout | tests/momentum-calculation-flow.test.ts
🚀 MOCK DATA: Loaded full dataset for development/demo
🚀 STARTING mockData.ts with dynamic import...
📋 Raw JSON data loaded: { habitsCount: 4, logsCount: 928 }
🔍 RAW JSON - Total logs: 928
🔍 RAW JSON - Date range: 2024-06-01 → 2025-07-02
🔍 RAW JSON - Unique dates: 386
🔍 RAW JSON - First 5 dates: [
  '2024-06-01',
  '2024-06-02',
  '2024-06-03',
  '2024-06-04',
  '2024-06-05'
]
🔍 RAW JSON - Last 5 dates: [
  '2025-06-27',
  '2025-06-28',
  '2025-06-30',
  '2025-07-01',
  '2025-07-02'
]
🔍 RAW JSON - 2025 logs found: 426
🔍 RAW JSON - Sample 2025 logs: [
  {
    id: '1-2025-01-02',
    habitId: '1',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '4-2025-01-02',
    habitId: '4',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '1-2025-01-03',
    habitId: '1',
    date: '2025-01-03',
    state: 'good'
  }
]
🔄 Phase 0 Migration: Filtered out bad state logs
📊 Logs: 928 → 928 (removed 0 bad logs)
📊 EXPORT VERIFICATION:
📊 Habits exported: 4
📊 Logs exported: 928
📊 Full date range: 2024-06-01 → 2025-07-02
📊 2025 logs found: 426
📊 2025 date range: 2025-01-02 → 2025-07-02
✅ SUCCESS: 2025 data loaded successfully!
📊 Sample June 2025 logs: [
  '2025-06-01: habit 2 = good',
  '2025-06-01: habit 3 = good',
  '2025-06-01: habit 4 = good',
  '2025-06-02: habit 1 = good',
  '2025-06-02: habit 2 = good'
]
📊 All unique dates count: 386
📊 First 10 dates: [
  '2024-06-01', '2024-06-02',
  '2024-06-03', '2024-06-04',
  '2024-06-05', '2024-06-06',
  '2024-06-07', '2024-06-08',
  '2024-06-09', '2024-06-10'
]
📊 Last 10 dates: [
  '2025-06-22', '2025-06-23',
  '2025-06-24', '2025-06-25',
  '2025-06-26', '2025-06-27',
  '2025-06-28', '2025-06-30',
  '2025-07-01', '2025-07-02'
]
🔄 Migration: Ensured default goal exists. Total goals: 4


 ❯ tests/compound.test.ts 9/9
 ❯ tests/goalSelector.test.tsx [queued]
stderr | tests/momentum-calculation-flow.test.ts
Unknown weight value 0.0003, defaulting to MEDIUM
Unknown weight value 0.0003, defaulting to MEDIUM


 ❯ tests/compound.test.ts 9/9
 ❯ tests/goalSelector.test.tsx [queued]
 ❯ tests/momentum-calculation-flow.test.ts (6 tests | 3 failed) 103ms
   ✓ Momentum Calculation Data Flow > should calculate daily rates for available dates 4ms
   × Momentum Calculation Data Flow > should have valid habit weights 13ms
     → expected [ 0.0005, 0.001, 0.0025, 0.004 ] to include 0.0002
   × Momentum Calculation Data Flow > should find logs for specific dates as shown in console 11ms
     → expected [ { id: '3-2025-06-06', …(3) } ] to have a length of 3 but got 1
   × Momentum Calculation Data Flow > should handle dates with no logs correctly 1ms
     → expected [ { id: '2-2025-06-12', …(3) }, …(2) ] to have a length of +0 but got 3
   ✓ Momentum Calculation Data Flow > should calculate momentum index correctly with real data 10ms
   ✓ Momentum Calculation Data Flow > should verify data flow produces valid data patterns 61ms
stdout | DataService.getGoals (/home/runner/workspace/client/src/services/dataService.ts:156:17)
🔍 DataService.getGoals() (MOCK-DEMO) → 4 goals

stdout | DataService.getHabits (/home/runner/workspace/client/src/services/dataService.ts:60:15)
🔍 DataService.getHabits() (MOCK-DEMO) → 4 habits


 ❯ tests/goalSelector.test.tsx [queued]




stderr | tests/rendering.test.tsx > Component Rendering > should render HabitRow with correct habit information
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
The above error occurred in the <HabitRow> component:

    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:17:21)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/rendering.test.tsx > Component Rendering > should handle habit toggle interaction
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
The above error occurred in the <HabitRow> component:

    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:17:21)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


stderr | tests/rendering.test.tsx > Component Rendering > should render WeightSlider with correct weight
Warning: React does not recognize the `whileHover` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `whilehover` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
    at button
    at button (/home/runner/workspace/tests/rendering.test.tsx:46:16)
    at div
    at div
    at WeightSlider (/home/runner/workspace/client/src/components/WeightSlider.tsx:18:25)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13
Warning: React does not recognize the `whileTap` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `whiletap` instead. If you accidentally passed it from a parent component, remove it from the DOM element.
    at button
    at button (/home/runner/workspace/tests/rendering.test.tsx:46:16)
    at div
    at div
    at WeightSlider (/home/runner/workspace/client/src/components/WeightSlider.tsx:18:25)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27165:5) TypeError: window.matchMedia is not a function
    at /home/runner/workspace/client/src/hooks/use-mobile.tsx:9:24
    at commitHookEffectListMount (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/workspace/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <WeightSlider> component:

    at WeightSlider (/home/runner/workspace/client/src/components/WeightSlider.tsx:18:25)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/rendering.test.tsx > Component Rendering > should handle weight slider changes
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27165:5) TypeError: window.matchMedia is not a function
    at /home/runner/workspace/client/src/hooks/use-mobile.tsx:9:24
    at commitHookEffectListMount (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/workspace/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <WeightSlider> component:

    at WeightSlider (/home/runner/workspace/client/src/components/WeightSlider.tsx:18:25)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/rendering.test.tsx > Component Rendering > should expand habit row to show weekly view
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
Error: Uncaught [TypeError: window.matchMedia is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: window.matchMedia is not a function
    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:91:53)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
The above error occurred in the <HabitRow> component:

    at HabitRow (/home/runner/workspace/client/src/components/HabitRow.tsx:17:21)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/rendering.test.tsx > Component Rendering > should render momentum chart components
Error: Uncaught [Error: useHabitsContext must be used within a HabitsProvider]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useHabitsContext must be used within a HabitsProvider
    at Module.useHabitsContext (/home/runner/workspace/client/src/contexts/HabitsContext.tsx:37:11)
    at Home (/home/runner/workspace/client/src/pages/Home.tsx:25:56)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: useHabitsContext must be used within a HabitsProvider]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useHabitsContext must be used within a HabitsProvider
    at Module.useHabitsContext (/home/runner/workspace/client/src/contexts/HabitsContext.tsx:37:11)
    at Home (/home/runner/workspace/client/src/pages/Home.tsx:25:56)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <Home> component:

    at Home (/home/runner/workspace/client/src/pages/Home.tsx:24:77)
    at QueryClientProvider (file:///home/runner/workspace/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at /home/runner/workspace/tests/rendering.test.tsx:81:13

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


 ❯ tests/rendering.test.tsx (6 tests | 6 failed) 231ms
   × Component Rendering > should render HabitRow with correct habit information 96ms
     → window.matchMedia is not a function
   × Component Rendering > should handle habit toggle interaction 11ms
     → window.matchMedia is not a function
   × Component Rendering > should render WeightSlider with correct weight 85ms
     → window.matchMedia is not a function
   × Component Rendering > should handle weight slider changes 16ms
     → window.matchMedia is not a function
   × Component Rendering > should expand habit row to show weekly view 7ms
     → window.matchMedia is not a function
   × Component Rendering > should render momentum chart components 13ms
     → useHabitsContext must be used within a HabitsProvider


 ❯ tests/goalSelector.test.tsx (6 tests | 2 failed) 449ms
   ✓ GoalSelector > renders none pill and goal options 138ms
   ✓ GoalSelector > calls onChange with empty array when None is clicked 45ms
   × GoalSelector > toggles goal selection correctly 90ms
     → Found multiple elements with the text: Short-term Goal

Here are the matching elements:

Ignored nodes: comments, script, style
<span
  class="font-medium text-gray-900 truncate"
>
  Short-term Goal
</span>

Ignored nodes: comments, script, style
<span
  class="font-medium text-gray-900 truncate"
>
  Short-term Goal
</span>

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="space-y-4"
    >
      <div
        class="relative"
      >
        <svg
          class="lucide lucide-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"
          fill="none"
          height="24"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          width="24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle
            cx="11"
            cy="11"
            r="8"
          />
          <path
            d="m21 21-4.3-4.3"
          />
        </svg>
        <input
          class="flex h-10 w-full rounded-md border px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10 pr-10 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400"
          placeholder="Search goals..."
          type="text"
          value=""
        />
      </div>
      <div
        class="flex flex-wrap gap-2"
      >
        <button
          class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 h-10 rounded-md px-3 min-h-[40px] text-sm bg-gray-700 text-white hover:bg-gray-600 border-gray-600"
        >
          None
        </button>
      </div>
      <div
        class="space-y-2 max-h-60 overflow-y-auto"
      >
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Short-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-green-100 text-green-800 border-green-200"
              >
                short
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A short-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Mid-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-yellow-100 text-yellow-800 border-yellow-200"
              >
                mid
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A mid-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Long-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-blue-100 text-blue-800 border-blue-200"
              >
                long
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A long-term goal
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div>
    <div
      class="space-y-4"
    >
      <div
        class="relative"
      >
        <svg
          class="lucide lucide-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"
          fill="none"
          height="24"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          width="24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle
            cx="11"
            cy="11"
            r="8"
          />
          <path
            d="m21 21-4.3-4.3"
          />
        </svg>
        <input
          class="flex h-10 w-full rounded-md border px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10 pr-10 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400"
          placeholder="Search goals..."
          type="text"
          value=""
        />
      </div>
      <div
        class="flex flex-wrap gap-2"
      >
        <button
          class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border bg-background h-10 rounded-md px-3 min-h-[40px] text-sm border-gray-600 text-gray-200 hover:bg-gray-700 hover:text-white"
        >
          None
        </button>
      </div>
      <div
        class="space-y-2 max-h-60 overflow-y-auto"
      >
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-blue-50 border-blue-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            checked=""
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Short-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-green-100 text-green-800 border-green-200"
              >
                short
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A short-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Mid-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-yellow-100 text-yellow-800 border-yellow-200"
              >
                mid
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A mid-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Long-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-blue-100 text-blue-800 border-blue-200"
              >
                long
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A long-term goal
            </p>
          </div>
        </div>
      </div>
      <div
        aria-live="polite"
        class="text-sm text-gray-600"
        role="status"
      >
        1
         goal
         selected
      </div>
    </div>
  </div>
</body>
   × GoalSelector > filters goals based on search term with debounce 74ms
     → expect(element).not.toBeInTheDocument()

expected document not to contain element, found <span
  class="font-medium text-gray-900 truncate"
>
  Mid-term Goal
</span> instead
   ✓ GoalSelector > shows selection summary when goals are selected 44ms
   ✓ GoalSelector > ensures goalIds array reflects final selections 52ms


stderr | tests/goalsIntegration.test.tsx > Goals Integration > creates a goal via GoalDialog and adds it to the list
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.
Error: Uncaught [TypeError: __vite_ssr_import_2__.dataService.getHabits is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: __vite_ssr_import_2__.dataService.getHabits is not a function
    at /home/runner/workspace/client/src/hooks/useHabits.ts:62:27
    at mountState (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:16167:20)
    at Object.useState (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:16880:16)
    at Proxy.useState (/home/runner/workspace/node_modules/react/cjs/react.development.js:1622:21)
    at Module.useHabits (/home/runner/workspace/client/src/hooks/useHabits.ts:38:27)
    at GoalCard (/home/runner/workspace/client/src/components/GoalCard.tsx:20:22)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
Error: Uncaught [TypeError: __vite_ssr_import_2__.dataService.getHabits is not a function]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) TypeError: __vite_ssr_import_2__.dataService.getHabits is not a function
    at /home/runner/workspace/client/src/hooks/useHabits.ts:62:27
    at mountState (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:16167:20)
    at Object.useState (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:16880:16)
    at Proxy.useState (/home/runner/workspace/node_modules/react/cjs/react.development.js:1622:21)
    at Module.useHabits (/home/runner/workspace/client/src/hooks/useHabits.ts:38:27)
    at GoalCard (/home/runner/workspace/client/src/components/GoalCard.tsx:20:22)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
The above error occurred in the <GoalCard> component:

    at GoalCard (/home/runner/workspace/client/src/components/GoalCard.tsx:19:21)
    at div
    at div
    at div
    at MotionComponent (file:///home/runner/workspace/node_modules/framer-motion/dist/es/motion/index.mjs:35:16)
    at div
    at Goals (/home/runner/workspace/client/src/pages/Goals.tsx:72:43)
    at GoalsProvider (/home/runner/workspace/client/src/contexts/GoalsContext.tsx:16:26)
    at TestWrapper (/home/runner/workspace/tests/goalsIntegration.test.tsx:19:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


stderr | tests/goalsIntegration.test.tsx > Goals Integration > validates required title field
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.


 ❯ tests/goalsIntegration.test.tsx (4 tests | 3 failed) 675ms
   × Goals Integration > creates a goal via GoalDialog and adds it to the list 502ms
     → dataService.getHabits is not a function
   × Goals Integration > toggles accordion expand/collapse state 22ms
     → Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalsIntegration.test.tsx
   ✓ Goals Integration > validates required title field 116ms
   × Goals Integration > hides FAB when list is empty and shows when goals exist 33ms
     → Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalsIntegration.test.tsx

stdout | tests/goals.test.tsx
🚀 MOCK DATA: Loaded full dataset for development/demo
🚀 STARTING mockData.ts with dynamic import...
📋 Raw JSON data loaded: { habitsCount: 4, logsCount: 928 }
🔍 RAW JSON - Total logs: 928
🔍 RAW JSON - Date range: 2024-06-01 → 2025-07-02
🔍 RAW JSON - Unique dates: 386
🔍 RAW JSON - First 5 dates: [
  '2024-06-01',
  '2024-06-02',
  '2024-06-03',
  '2024-06-04',
  '2024-06-05'
]
🔍 RAW JSON - Last 5 dates: [
  '2025-06-27',
  '2025-06-28',
  '2025-06-30',
  '2025-07-01',
  '2025-07-02'
]
🔍 RAW JSON - 2025 logs found: 426
🔍 RAW JSON - Sample 2025 logs: [
  {
    id: '1-2025-01-02',
    habitId: '1',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '4-2025-01-02',
    habitId: '4',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '1-2025-01-03',
    habitId: '1',
    date: '2025-01-03',
    state: 'good'
  }
]
🔄 Phase 0 Migration: Filtered out bad state logs
📊 Logs: 928 → 928 (removed 0 bad logs)
📊 EXPORT VERIFICATION:
📊 Habits exported: 4
📊 Logs exported: 928
📊 Full date range: 2024-06-01 → 2025-07-02
📊 2025 logs found: 426
📊 2025 date range: 2025-01-02 → 2025-07-02
✅ SUCCESS: 2025 data loaded successfully!
📊 Sample June 2025 logs: [
  '2025-06-01: habit 2 = good',
  '2025-06-01: habit 3 = good',
  '2025-06-01: habit 4 = good',
  '2025-06-02: habit 1 = good',
  '2025-06-02: habit 2 = good'
]
📊 All unique dates count: 386
📊 First 10 dates: [
  '2024-06-01', '2024-06-02',
  '2024-06-03', '2024-06-04',
  '2024-06-05', '2024-06-06',
  '2024-06-07', '2024-06-08',
  '2024-06-09', '2024-06-10'
]
📊 Last 10 dates: [
  '2025-06-22', '2025-06-23',
  '2025-06-24', '2025-06-25',
  '2025-06-26', '2025-06-27',
  '2025-06-28', '2025-06-30',
  '2025-07-01', '2025-07-02'
]
🔄 Migration: Ensured default goal exists. Total goals: 4

stderr | tests/goals.test.tsx
Unknown weight value 0.0003, defaulting to MEDIUM
Unknown weight value 0.0003, defaulting to MEDIUM


 ❯ tests/data-flow-integration.test.ts [queued]
 ❯ tests/goalDeletion.test.tsx (1 test | 1 failed) 33ms
   × Goal Deletion Cascade > strips deleted goal ID from all habits in single batch update 31ms
     → Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalDeletion.test.tsx

stderr | tests/goals.test.tsx > Goals Page > renders empty state with CTA when no goals exist
Error: Uncaught [Error: useGoalsContext must be used within a GoalsProvider]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useGoalsContext must be used within a GoalsProvider
    at Module.useGoalsContext (/home/runner/workspace/client/src/contexts/GoalsContext.tsx:20:11)
    at Goals (/home/runner/workspace/client/src/pages/Goals.tsx:36:21)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: useGoalsContext must be used within a GoalsProvider]
    at reportException (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: useGoalsContext must be used within a GoalsProvider
    at Module.useGoalsContext (/home/runner/workspace/client/src/contexts/GoalsContext.tsx:20:11)
    at Goals (/home/runner/workspace/client/src/pages/Goals.tsx:36:21)
    at renderWithHooks (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/workspace/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/workspace/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <Goals> component:

    at Goals (/home/runner/workspace/client/src/pages/Goals.tsx:72:43)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.


 ❯ tests/goals.test.tsx (1 test | 1 failed) 83ms
   × Goals Page > renders empty state with CTA when no goals exist 80ms
     → useGoalsContext must be used within a GoalsProvider
stdout | tests/time-filter-integration.test.ts
🚀 MOCK DATA: Loaded full dataset for development/demo
🚀 STARTING mockData.ts with dynamic import...
📋 Raw JSON data loaded: { habitsCount: 4, logsCount: 928 }
🔍 RAW JSON - Total logs: 928
🔍 RAW JSON - Date range: 2024-06-01 → 2025-07-02
🔍 RAW JSON - Unique dates: 386
🔍 RAW JSON - First 5 dates: [
  '2024-06-01',
  '2024-06-02',
  '2024-06-03',
  '2024-06-04',
  '2024-06-05'
]
🔍 RAW JSON - Last 5 dates: [
  '2025-06-27',
  '2025-06-28',
  '2025-06-30',
  '2025-07-01',
  '2025-07-02'
]
🔍 RAW JSON - 2025 logs found: 426
🔍 RAW JSON - Sample 2025 logs: [
  {
    id: '1-2025-01-02',
    habitId: '1',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '4-2025-01-02',
    habitId: '4',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '1-2025-01-03',
    habitId: '1',
    date: '2025-01-03',
    state: 'good'
  }
]
🔄 Phase 0 Migration: Filtered out bad state logs
📊 Logs: 928 → 928 (removed 0 bad logs)
📊 EXPORT VERIFICATION:
📊 Habits exported: 4
📊 Logs exported: 928
📊 Full date range: 2024-06-01 → 2025-07-02
📊 2025 logs found: 426
📊 2025 date range: 2025-01-02 → 2025-07-02
✅ SUCCESS: 2025 data loaded successfully!
📊 Sample June 2025 logs: [
  '2025-06-01: habit 2 = good',
  '2025-06-01: habit 3 = good',
  '2025-06-01: habit 4 = good',
  '2025-06-02: habit 1 = good',
  '2025-06-02: habit 2 = good'
]
📊 All unique dates count: 386
📊 First 10 dates: [
  '2024-06-01', '2024-06-02',
  '2024-06-03', '2024-06-04',
  '2024-06-05', '2024-06-06',
  '2024-06-07', '2024-06-08',
  '2024-06-09', '2024-06-10'
]
📊 Last 10 dates: [
  '2025-06-22', '2025-06-23',
  '2025-06-24', '2025-06-25',
  '2025-06-26', '2025-06-27',
  '2025-06-28', '2025-06-30',
  '2025-07-01', '2025-07-02'
]
🔄 Migration: Ensured default goal exists. Total goals: 4

stderr | tests/time-filter-integration.test.ts
Unknown weight value 0.0003, defaulting to MEDIUM
Unknown weight value 0.0003, defaulting to MEDIUM

stdout | tests/time-filter-integration.test.ts
🔍 DataService.getGoals() (MOCK-DEMO) → 4 goals
🔍 DataService.getHabits() (MOCK-DEMO) → 4 habits
🔍 DataService.saveHabits() saved 4 habits
🔄 Migration: Updated habits with default goal assignments
✅ Migration: Phase 0.5 migration completed


stdout | tests/chart-time-filter-debug.test.ts
🚀 MOCK DATA: Loaded full dataset for development/demo
🚀 STARTING mockData.ts with dynamic import...
📋 Raw JSON data loaded: { habitsCount: 4, logsCount: 928 }
🔍 RAW JSON - Total logs: 928
🔍 RAW JSON - Date range: 2024-06-01 → 2025-07-02
🔍 RAW JSON - Unique dates: 386
🔍 RAW JSON - First 5 dates: [
  '2024-06-01',
  '2024-06-02',
  '2024-06-03',
  '2024-06-04',
  '2024-06-05'
]
🔍 RAW JSON - Last 5 dates: [
  '2025-06-27',
  '2025-06-28',
  '2025-06-30',
  '2025-07-01',
  '2025-07-02'
]
🔍 RAW JSON - 2025 logs found: 426
🔍 RAW JSON - Sample 2025 logs: [
  {
    id: '1-2025-01-02',
    habitId: '1',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '4-2025-01-02',
    habitId: '4',
    date: '2025-01-02',
    state: 'good'
  },
  {
    id: '1-2025-01-03',
    habitId: '1',
    date: '2025-01-03',
    state: 'good'
  }
]
🔄 Phase 0 Migration: Filtered out bad state logs
📊 Logs: 928 → 928 (removed 0 bad logs)
📊 EXPORT VERIFICATION:
📊 Habits exported: 4
📊 Logs exported: 928
📊 Full date range: 2024-06-01 → 2025-07-02
📊 2025 logs found: 426
📊 2025 date range: 2025-01-02 → 2025-07-02
✅ SUCCESS: 2025 data loaded successfully!
📊 Sample June 2025 logs: [
  '2025-06-01: habit 2 = good',
  '2025-06-01: habit 3 = good',
  '2025-06-01: habit 4 = good',
  '2025-06-02: habit 1 = good',
  '2025-06-02: habit 2 = good'
]
📊 All unique dates count: 386
📊 First 10 dates: [
  '2024-06-01', '2024-06-02',
  '2024-06-03', '2024-06-04',
  '2024-06-05', '2024-06-06',
  '2024-06-07', '2024-06-08',
  '2024-06-09', '2024-06-10'
]
📊 Last 10 dates: [
  '2025-06-22', '2025-06-23',
  '2025-06-24', '2025-06-25',
  '2025-06-26', '2025-06-27',
  '2025-06-28', '2025-06-30',
  '2025-07-01', '2025-07-02'
]
🔄 Migration: Ensured default goal exists. Total goals: 4


stderr | tests/chart-time-filter-debug.test.ts
Unknown weight value 0.0003, defaulting to MEDIUM
Unknown weight value 0.0003, defaulting to MEDIUM


stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should filter data correctly for 'All Time'
Time Filter: All Time selected, using all data
Total logs available: 928
Generating momentum history for All Time: 386 days
Momentum history: 386 days from 2024-06-01 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for All Time: 120 historical days from window of 120
Latest Rate: Using most recent date with data: 2025-07-02

stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should filter data correctly for '30 D'
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02


stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should filter data correctly for '4 M'
Time filtering: 4 M → 251/928 logs
Generating momentum history for 4 M: 106 days
Momentum history: 106 days from 2025-03-15 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for 4 M: 90 historical days from window of 90
Latest Rate: Using most recent date with data: 2025-07-02


 ❯ tests/chart-time-filter-debug.test.ts 0/2
stdout | tests/chart-time-filter-debug.test.ts > Chart Time Filter Data Flow Debug > should verify complete data flow from time filter to chart
Time Filter: All Time selected, using all data
Total logs available: 928
Generating momentum history for All Time: 386 days
Momentum history: 386 days from 2024-06-01 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for All Time: 120 historical days from window of 120
Latest Rate: Using most recent date with data: 2025-07-02
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02
=== DATA FLOW DEBUG ===
All Time momentum data length: 386
30 Day momentum data length: 28
All Time date range: { start: '2024-06-23', end: '2025-07-13' }
30 Day date range: { start: '2025-06-24', end: '2025-07-20' }
All Time current momentum: 1.2636680672968081
30 Day current momentum: 1.0109558575077964


 ❯ tests/chart-time-filter-debug.test.ts 0/2
stdout | tests/chart-time-filter-debug.test.ts > Chart Time Filter Data Flow Debug > should verify chart receives correct filtered data props
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02
=== CHART PROPS DEBUG ===
Chart will receive data points: 28
Chart data date range: { start: '2025-06-24', end: '2025-07-20' }
Chart current momentum: 1.0109558575077964
Chart total growth: 0.31038424087951

stdout | tests/chart-time-filter-debug.test.ts
🔍 DataService.getGoals() (MOCK-DEMO) → 4 goals
🔍 DataService.getHabits() (MOCK-DEMO) → 4 habits
🔍 DataService.saveHabits() saved 4 habits
🔄 Migration: Updated habits with default goal assignments
✅ Migration: Phase 0.5 migration completed

 ✓ tests/chart-time-filter-debug.test.ts (2 tests) 1383ms
   ✓ Chart Time Filter Data Flow Debug > should verify complete data flow from time filter to chart  1344ms
stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should filter data correctly for '1 Y'
Time filtering: 1 Y → 831/928 logs
Generating momentum history for 1 Y: 345 days
Momentum history: 345 days from 2024-07-13 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for 1 Y: 90 historical days from window of 90
[DRATE] 2025-06-11 3 3
Latest Rate: Using most recent date with data: 2025-07-02
🔍 1Y Projection Debug:
  Current Momentum (exact): 1.2333413820618777
  Recent Avg Rate (exact): 0.0005033333333333336
  Projection Days: 90
  Manual Calc Check: 1.2333413820618777 * (1 + 0.0005033333333333336 )^ 90
  Manual Result: 1.2904818300226635
  App Result: 1.2904818300226635
  Your Calc (1.988 * 1.0019^120): 2.4965574981664833


 ✓ tests/goalUtils.test.ts (5 tests) 5ms
stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should filter logs based on time range
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02
Time Filter: All Time selected, using all data
Total logs available: 928
Generating momentum history for All Time: 386 days
Momentum history: 386 days from 2024-06-01 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for All Time: 120 historical days from window of 120
Latest Rate: Using most recent date with data: 2025-07-02

stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should handle date filtering correctly in useMomentum hook
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02

stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should recalculate when time filter changes
Time filtering: 30 D → 43/928 logs
Generating momentum history for 30 D: 19 days
Momentum history: 19 days from 2025-06-13 to 2025-07-13
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
[DRATE] 2025-06-11 0 0
Recent Avg Rate calc for 30 D: 7 historical days from window of 7
[DRATE] 2025-06-11 0 0
Latest Rate: Using most recent date with data: 2025-07-02
Time filtering: 4 M → 251/928 logs
Generating momentum history for 4 M: 106 days
Momentum history: 106 days from 2025-03-15 to 2025-07-13
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
[DRATE] 2025-06-11 3 3
Recent Avg Rate calc for 4 M: 90 historical days from window of 90
Latest Rate: Using most recent date with data: 2025-07-02

stdout | tests/time-filter-integration.test.ts > Time Filter Integration > should handle edge case of no logs in time range
Time filtering: Future 7 Days → 0/928 logs

 ✓ tests/time-filter-integration.test.ts (9 tests) 3832ms
   ✓ Time Filter Integration > should filter data correctly for 'All Time'  1302ms
   ✓ Time Filter Integration > should filter data correctly for '1 Y'  1087ms
   ✓ Time Filter Integration > should filter logs based on time range  998ms

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/data-flow-integration.test.ts [ tests/data-flow-integration.test.ts ]
Error: Failed to resolve import "../client/src/data/myMockData.json" from "tests/data-flow-integration.test.ts". Does the file exist?
  Plugin: vite:import-analysis
  File: /home/runner/workspace/tests/data-flow-integration.test.ts:24:35
  12 |    describe("Step 1: JSON Data Import Validation", () => {
  13 |      it("should import raw JSON data correctly", async () => {
  14 |        const rawData = await import("../client/src/data/myMockData.json");
     |                                     ^
  15 |        expect(rawData.habits).toBeDefined();
  16 |        expect(rawData.logs).toBeDefined();
 ❯ TransformPluginContext._formatError node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:49257:41
 ❯ TransformPluginContext.error node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:49252:16
 ❯ normalizeUrl node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:64199:23
 ❯ node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:64331:39
 ❯ TransformPluginContext.transform node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:64258:7
 ❯ PluginContainer.transform node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:49098:18
 ❯ loadAndTransform node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:51931:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/21]⎯


⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 20 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/compound.test.ts > Compound Growth Calculations > should calculate daily rate correctly
AssertionError: expected 0.0003 to be 0.0025 // Object.is equality

- Expected
+ Received

- 0.0025
+ 0.0003

 ❯ tests/compound.test.ts:45:19
     43|     // Day 1: habit 1 good (+0.0025), habit 2 unlogged (0) = 0.0025
     44|     const rate1 = calculateDailyRate(mockHabits, mockLogs, '2024-01-01');
     45|     expect(rate1).toBe(0.0025);
       |                   ^
     46| 
     47|     // Day 2: both habits good (0.0025 + 0.001 = 0.0035)

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/21]⎯

 FAIL  tests/compound.test.ts > Compound Growth Calculations > should calculate momentum index with compound growth
AssertionError: expected 1.00090018 to be close to 1.006009, received difference is 0.005108820000000014, but expected 0.0000049999999999999996
 ❯ tests/compound.test.ts:64:22
     62|     // Expected: 1.0 * (1 + 0.0025) * (1 + 0.0035) = 1.0060087500000001
     63|     // Calculation: 1.0025 * 1.0035 = 1.0060087500000001
     64|     expect(momentum).toBeCloseTo(1.006009, 5);
       |                      ^
     65|   });
     66| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/21]⎯

 FAIL  tests/compound.test.ts > Compound Growth Calculations > should generate 30-day projection
AssertionError: expected [ { date: '2025-07-14', …(4) }, …(6) ] to have a length of 30 but got 7

- Expected
+ Received

- 30
+ 7

 ❯ tests/compound.test.ts:89:24
     87|     const projection = generate30DayProjection(mockHabits, mockLogs);
     88|     
     89|     expect(projection).toHaveLength(30);
       |                        ^
     90|     expect(projection[0]).toHaveProperty('date');
     91|     expect(projection[0]).toHaveProperty('value');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/21]⎯

 FAIL  tests/compound.test.ts > Compound Growth Calculations > should maintain precision in compound calculations
AssertionError: expected 1.0201992998981269 to be close to 1.0512, received difference is 0.031000700101873058, but expected 0.0005
 ❯ tests/compound.test.ts:144:22
    142|     
    143|     // Should be approximately (1.0005)^100 ≈ 1.0512
    144|     expect(momentum).toBeCloseTo(1.0512, 3);
       |                      ^
    145|   });
    146| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/21]⎯

 FAIL  tests/goalDeletion.test.tsx > Goal Deletion Cascade > strips deleted goal ID from all habits in single batch update
Error: Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalDeletion.test.tsx
 ❯ tests/goalDeletion.test.tsx:37:29
     35| 
     36|   it('strips deleted goal ID from all habits in single batch update', async () =>…
     37|     const { dataService } = require('@/services/dataService');
       |                             ^
     38|     
     39|     render(

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/21]⎯

 FAIL  tests/goalSelector.test.tsx > GoalSelector > toggles goal selection correctly
TestingLibraryElementError: Found multiple elements with the text: Short-term Goal

Here are the matching elements:

Ignored nodes: comments, script, style
<span
  class="font-medium text-gray-900 truncate"
>
  Short-term Goal
</span>

Ignored nodes: comments, script, style
<span
  class="font-medium text-gray-900 truncate"
>
  Short-term Goal
</span>

(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="space-y-4"
    >
      <div
        class="relative"
      >
        <svg
          class="lucide lucide-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"
          fill="none"
          height="24"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          width="24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle
            cx="11"
            cy="11"
            r="8"
          />
          <path
            d="m21 21-4.3-4.3"
          />
        </svg>
        <input
          class="flex h-10 w-full rounded-md border px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10 pr-10 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400"
          placeholder="Search goals..."
          type="text"
          value=""
        />
      </div>
      <div
        class="flex flex-wrap gap-2"
      >
        <button
          class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 h-10 rounded-md px-3 min-h-[40px] text-sm bg-gray-700 text-white hover:bg-gray-600 border-gray-600"
        >
          None
        </button>
      </div>
      <div
        class="space-y-2 max-h-60 overflow-y-auto"
      >
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Short-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-green-100 text-green-800 border-green-200"
              >
                short
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A short-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Mid-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-yellow-100 text-yellow-800 border-yellow-200"
              >
                mid
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A mid-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Long-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-blue-100 text-blue-800 border-blue-200"
              >
                long
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A long-term goal
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div>
    <div
      class="space-y-4"
    >
      <div
        class="relative"
      >
        <svg
          class="lucide lucide-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"
          fill="none"
          height="24"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          width="24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle
            cx="11"
            cy="11"
            r="8"
          />
          <path
            d="m21 21-4.3-4.3"
          />
        </svg>
        <input
          class="flex h-10 w-full rounded-md border px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10 pr-10 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400"
          placeholder="Search goals..."
          type="text"
          value=""
        />
      </div>
      <div
        class="flex flex-wrap gap-2"
      >
        <button
          class="inline-flex items-center justify-center gap-2 whitespace-nowrap font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border bg-background h-10 rounded-md px-3 min-h-[40px] text-sm border-gray-600 text-gray-200 hover:bg-gray-700 hover:text-white"
        >
          None
        </button>
      </div>
      <div
        class="space-y-2 max-h-60 overflow-y-auto"
      >
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-blue-50 border-blue-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            checked=""
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Short-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-green-100 text-green-800 border-green-200"
              >
                short
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A short-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Mid-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-yellow-100 text-yellow-800 border-yellow-200"
              >
                mid
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A mid-term goal
            </p>
          </div>
        </div>
        <div
          class="flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-colors bg-white hover:bg-gray-50 border-gray-200"
          style="opacity: 0; transform: translateY(10px);"
        >
          <input
            class="h-4 w-4 text-blue-600 rounded"
            type="checkbox"
          />
          <div
            class="flex-1 min-w-0"
          >
            <div
              class="flex items-center gap-2"
            >
              <span
                class="font-medium text-gray-900 truncate"
              >
                Long-term Goal
              </span>
              <span
                class="px-2 py-1 text-xs rounded-full border bg-blue-100 text-blue-800 border-blue-200"
              >
                long
              </span>
            </div>
            <p
              class="text-sm text-gray-500 truncate"
            >
              A long-term goal
            </p>
          </div>
        </div>
      </div>
      <div
        aria-live="polite"
        class="text-sm text-gray-600"
        role="status"
      >
        1
         goal
         selected
      </div>
    </div>
  </div>
</body>
 ❯ Object.getElementError node_modules/@testing-library/dom/dist/config.js:37:19
 ❯ getElementError node_modules/@testing-library/dom/dist/query-helpers.js:20:35
 ❯ getMultipleElementsFoundError node_modules/@testing-library/dom/dist/query-helpers.js:23:10
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:55:13
 ❯ node_modules/@testing-library/dom/dist/query-helpers.js:95:19
 ❯ tests/goalSelector.test.tsx:94:28
     92|     );
     93| 
     94|     fireEvent.click(screen.getByText('Short-term Goal'));
       |                            ^
     95|     expect(mockOnChange).toHaveBeenCalledWith([]);
     96|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/21]⎯

 FAIL  tests/goalSelector.test.tsx > GoalSelector > filters goals based on search term with debounce
Error: expect(element).not.toBeInTheDocument()

expected document not to contain element, found <span
  class="font-medium text-gray-900 truncate"
>
  Mid-term Goal
</span> instead
 ❯ tests/goalSelector.test.tsx:113:53
    111|     }, { timeout: 200 });
    112| 
    113|     expect(screen.queryByText('Mid-term Goal')).not.toBeInTheDocument();
       |                                                     ^
    114|     expect(screen.queryByText('Long-term Goal')).not.toBeInTheDocument();
    115|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/21]⎯

 FAIL  tests/goals.test.tsx > Goals Page > renders empty state with CTA when no goals exist
Error: useGoalsContext must be used within a GoalsProvider
 ❯ Module.useGoalsContext client/src/contexts/GoalsContext.tsx:20:11
     18|   const context = useContext(GoalsContext);
     19|   if (!context) {
     20|     throw new Error('useGoalsContext must be used within a GoalsProvider');
       |           ^
     21|   }
     22|   return context;
 ❯ Goals client/src/pages/Goals.tsx:36:21
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/21]⎯

 FAIL  tests/goalsIntegration.test.tsx > Goals Integration > creates a goal via GoalDialog and adds it to the list
TypeError: dataService.getHabits is not a function
 ❯ client/src/hooks/useHabits.ts:62:27
     60|     // Fallback to dataService
     61|     return {
     62|       habits: dataService.getHabits(),
       |                           ^
     63|       logs: dataService.getLogs(),
     64|       settings: { theme: 'light', nerdMode: false }
 ❯ mountState node_modules/react-dom/cjs/react-dom.development.js:16167:20
 ❯ Object.useState node_modules/react-dom/cjs/react-dom.development.js:16880:16
 ❯ Proxy.useState node_modules/react/cjs/react.development.js:1622:21
 ❯ Module.useHabits client/src/hooks/useHabits.ts:38:27
 ❯ GoalCard client/src/components/GoalCard.tsx:20:22
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/21]⎯

 FAIL  tests/goalsIntegration.test.tsx > Goals Integration > toggles accordion expand/collapse state
Error: Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalsIntegration.test.tsx
 ❯ tests/goalsIntegration.test.tsx:73:15
     71| 
     72|     // Update mock before rendering
     73|     vi.mocked(require('@/services/dataService').dataService.getGoals).mockReturnV…
       |               ^
     74| 
     75|     render(

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/21]⎯

 FAIL  tests/goalsIntegration.test.tsx > Goals Integration > hides FAB when list is empty and shows when goals exist
Error: Cannot find module '@/services/dataService'
Require stack:
- /home/runner/workspace/tests/goalsIntegration.test.tsx
 ❯ tests/goalsIntegration.test.tsx:137:15
    135|     // Mock goals data for rerender
    136|     const mockGoals = [{ id: '1', title: 'Test Goal', createdAt: new Date() }];
    137|     vi.mocked(require('@/services/dataService').dataService.getGoals).mockReturnV…
       |               ^
    138| 
    139|     // Rerender with goals present

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/21]⎯

 FAIL  tests/momentum-calculation-flow.test.ts > Momentum Calculation Data Flow > should have valid habit weights
AssertionError: expected [ 0.0005, 0.001, 0.0025, 0.004 ] to include 0.0002
 ❯ tests/momentum-calculation-flow.test.ts:35:28
     33|     
     34|     mockHabits.forEach(habit => {
     35|       expect(validWeights).toContain(habit.weight);
       |                            ^
     36|       expect(habit.weight).toBeGreaterThan(0);
     37|     });
 ❯ tests/momentum-calculation-flow.test.ts:34:16

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/21]⎯

 FAIL  tests/momentum-calculation-flow.test.ts > Momentum Calculation Data Flow > should find logs for specific dates as shown in console
AssertionError: expected [ { id: '3-2025-06-06', …(3) } ] to have a length of 3 but got 1

- Expected
+ Received

- 3
+ 1

 ❯ tests/momentum-calculation-flow.test.ts:50:26
     48|     // Test 2025-06-06: Should have 3 logs (1 bad, 2 bad, 3 good)
     49|     const logs20250606 = mockLogs.filter(log => log.date === '2025-06-06');
     50|     expect(logs20250606).toHaveLength(3);
       |                          ^
     51|     
     52|     // Test 2025-06-11: Should have 3 logs, all good

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/21]⎯

 FAIL  tests/momentum-calculation-flow.test.ts > Momentum Calculation Data Flow > should handle dates with no logs correctly
AssertionError: expected [ { id: '2-2025-06-12', …(3) }, …(2) ] to have a length of +0 but got 3

- Expected
+ Received

- 0
+ 3

 ❯ tests/momentum-calculation-flow.test.ts:63:26
     61|     // Test dates that should have 0 logs (like 2025-06-12, 2025-06-13)
     62|     const logs20250612 = mockLogs.filter(log => log.date === '2025-06-12');
     63|     expect(logs20250612).toHaveLength(0);
       |                          ^
     64|     
     65|     const rate20250612 = calculateDailyRate(mockHabits, mockLogs, '2025-06-12');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/21]⎯

 FAIL  tests/rendering.test.tsx > Component Rendering > should render HabitRow with correct habit information
 FAIL  tests/rendering.test.tsx > Component Rendering > should handle habit toggle interaction
 FAIL  tests/rendering.test.tsx > Component Rendering > should expand habit row to show weekly view
TypeError: window.matchMedia is not a function
 ❯ HabitRow client/src/components/HabitRow.tsx:91:53
     89|       animate={{ opacity: 1, y: 0 }}
     90|       transition={{ 
     91|         duration: window.innerWidth < 768 || window.matchMedia('(prefers-reduced-…
       |                                                     ^
     92|       }}
     93|     >
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20
 ❯ performConcurrentWorkOnRoot node_modules/react-dom/cjs/react-dom.development.js:25789:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/21]⎯

 FAIL  tests/rendering.test.tsx > Component Rendering > should render WeightSlider with correct weight
 FAIL  tests/rendering.test.tsx > Component Rendering > should handle weight slider changes
TypeError: window.matchMedia is not a function
 ❯ client/src/hooks/use-mobile.tsx:9:24
      7| 
      8|   React.useEffect(() => {
      9|     const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
       |                        ^
     10|     const onChange = () => {
     11|       setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/21]⎯

 FAIL  tests/rendering.test.tsx > Component Rendering > should render momentum chart components
Error: useHabitsContext must be used within a HabitsProvider
 ❯ Module.useHabitsContext client/src/contexts/HabitsContext.tsx:37:11
     35|   const context = useContext(HabitsContext);
     36|   if (!context) {
     37|     throw new Error('useHabitsContext must be used within a HabitsProvider');
       |           ^
     38|   }
     39|   return context;
 ❯ Home client/src/pages/Home.tsx:25:56
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/21]⎯

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Unhandled Errors ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

Vitest caught 2 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
ReferenceError: localStorage is not defined
 ❯ DataService.saveHabits client/src/services/dataService.ts:196:20
    194|       : 'compounded-data';
    195| 
    196|     const stored = localStorage.getItem(key);
       |                    ^
    197|     let data = { habits: [], logs: [], goals: [] };
    198| 
 ❯ client/src/utils/migration.ts:71:19
 ❯ processTicksAndRejections node:internal/process/task_queues:95:5

This error originated in "tests/momentum-calculation-flow.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
This error was caught after test environment was torn down. Make sure to cancel any running tasks before test finishes:
- cancel timeouts using clearTimeout and clearInterval
- wait for promises to resolve using the await keyword

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Unhandled Rejection ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
TypeError: Cannot read properties of undefined (reading 'getGoals')
 ❯ client/src/utils/migration.ts:54:38
     52|   // Import dataService dynamically to avoid circular dependency
     53|   import('@/services/dataService').then(({ dataService }) => {
     54|     const currentGoals = dataService.getGoals();
       |                                      ^
     55|     const currentHabits = dataService.getHabits();
     56|     
 ❯ processTicksAndRejections node:internal/process/task_queues:95:5

This error originated in "tests/goals.test.tsx" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯


 Test Files  8 failed | 3 passed (11)
      Tests  20 failed | 29 passed (49)
     Errors  2 errors
   Start at  05:15:39
   Duration  16.92s (transform 2.38s, setup 6.73s, collect 18.93s, tests 6.90s, environment 25.10s, prepare 6.36s)

